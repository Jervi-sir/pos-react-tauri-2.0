SELECT name FROM sqlite_master WHERE type='table';


CREATE TABLE users (
  id                  INTEGER PRIMARY KEY,
  name                TEXT,
  email               TEXT,
  password            TEXT,
  password_plain_text TEXT,
  role                TEXT CHECK(role IN ('owner', 'cashier', 'admin')),
  created_at          TEXT,
  updated_at          TEXT
);

CREATE TABLE invoices (
  id           INTEGER PRIMARY KEY,
  invoice_type TEXT CHECK(invoice_type IN ('sale', 'stock_purchase')),
  amount       TEXT,
  created_at   TEXT,
  updated_at   TEXT,
  created_by   INTEGER NOT NULL,
  FOREIGN KEY(created_by) REFERENCES users(id)
);

CREATE TABLE stock_entries (
  id             INTEGER PRIMARY KEY,
  product_id     INTEGER,
  quantity       INTEGER,
  purchase_price REAL,
  supplier       TEXT,
  added_by       INTEGER NOT NULL,
  created_at     TEXT,
  updated_at     TEXT,
  FOREIGN KEY(product_id) REFERENCES products(id),
  FOREIGN KEY(added_by) REFERENCES users(id)
);

CREATE TABLE products (
  id          INTEGER PRIMARY KEY,
  category_id INTEGER NOT NULL,
  name        TEXT NOT NULL,
  barcode     TEXT NOT NULL,
  image_url   TEXT,
  price_unit  REAL NOT NULL DEFAULT 0,
  created_at  TEXT NOT NULL,
  updated_at  TEXT NOT NULL,
  FOREIGN KEY(category_id) REFERENCES categories(id)
);

CREATE TABLE sales (
  id          INTEGER PRIMARY KEY,
  sold_by     INTEGER NOT NULL,
  total_price REAL,
  created_at  TEXT,
  updated_at  TEXT,
  FOREIGN KEY(sold_by) REFERENCES users(id)
);

CREATE TABLE product_images (
  id         INTEGER PRIMARY KEY,
  product_id INTEGER NOT NULL,
  image_url  TEXT,
  created_at TEXT,
  FOREIGN KEY(product_id) REFERENCES products(id)
);

CREATE TABLE categories (
  id         INTEGER PRIMARY KEY,
  name       TEXT NOT NULL,
  created_at TEXT NOT NULL
);

CREATE TABLE sale_items (
  id         INTEGER PRIMARY KEY,
  product_id INTEGER NOT NULL,
  sale_id    INTEGER NOT NULL,
  quantity   INTEGER NOT NULL,
  price_unit REAL NOT NULL,
  subtotal   REAL NOT NULL,
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL,
  FOREIGN KEY(product_id) REFERENCES products(id),
  FOREIGN KEY(sale_id) REFERENCES sales(id)
);
